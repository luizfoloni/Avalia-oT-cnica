-- Script para criação de uma database para alocar as tabelas

CREATE DATABASE ielDB;

-- Script para criação das tabelas

CREATE TABLE QUESTAO02 (

Q02_CD_DEP   INT PRIMARY KEY ,
Q02_NM_RESP  VARCHAR (255),
Q02_NM_LOGIN VARCHAR (20),
Q02_NM_EMAIL VARCHAR (20)

)


-- Script para criação da procedure

USE [ielDB]

CREATE PROCEDURE  [dbo].[SP_QUESTAO02] 

AS

@CODIGO_DEP INT ,
@NOME_RESPONSAVEL_DEP  VARCHAR (255),
@LOGIN_RESPONSAVEL_DEP VARCHAR (20),
@EMAIL_RESPONSAVEL_DEP VARCHAR (20)

BEGIN

IF 
    (
	SELECT COUNT(Q02_CD_DEP) FROM ielDB.dbo.QUESTAO02 WHERE Q02_CD_DEP = @CODIGO_DEP
	) = 0 

   INSERT INTO ielDB.dbo.QUESTAO02 (Q02_CD_DEP,Q02_NM_RESP,Q02_NM_LOGIN,Q02_NM_EMAIL) VALUES (@CODIGO_DEP,@NOME_RESPONSAVEL_DEP,@LOGIN_RESPONSAVEL_DEP,@EMAIL_RESPONSAVEL_DEP)

ELSE 
   (
   UPDATE ielDB.dbo.QUESTAO02 SET Q02_NM_RESP = @NOME_RESPONSAVEL_DEP , Q02_NM_LOGIN =@LOGIN_RESPONSAVEL_DEP , Q02_NM_EMAIL = @EMAIL_RESPONSAVEL_DEP WHERE Q02_CD_DEP = @CODIGO_DEP
   )

  END

